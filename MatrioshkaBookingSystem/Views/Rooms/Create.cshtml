@model MatrioshkaBookingSystem.Models.Room
@{
    Layout = "_Layout";
    ViewData["BodyClass"] = "admin-page";
}

<div class="form-card">

    <h2>Create Room</h2>

    <form method="post">

        <!-- HOTEL -->
        <label>Hotel:</label>
        <select id="hotelSelect" required>
            <option disabled selected>Select a Hotel</option>
            @foreach (var h in ViewBag.Hotels)
            {
                <option value="@h.HotelId">@h.HotelName</option>
            }
        </select>

        <!-- FLOOR -->
        <label>Floor:</label>
        <select name="FloorId" id="floorSelect" required>
            <option disabled selected>Select a Floor</option>
        </select>

        <!-- TYPE -->
        <label>Room Type:</label>
        <select name="TypeId" required>
            @foreach (var t in ViewBag.RoomTypes)
            {
                <option value="@t.TypeId">@t.TypeName</option>
            }
        </select>

        <!-- ASSETS -->
        <label>Assets:</label>
        <div>
            @foreach (var asset in ViewBag.Assets)
            {
                <div>
                    <input type="checkbox" name="SelectedAssetIds" value="@asset.AssetId" />
                    <label>@asset.AssetName</label>
                </div>
            }
        </div>

        <!-- STATUS -->
        <label>Status:</label>
        <select name="RoomStatus">
            <option value="Available">Available</option>
            <option value="Occupied">Occupied</option>
            <option value="Maintenance">Maintenance</option>
        </select>

        <button type="submit">Create</button>

    </form>
</div>

@section Scripts {
    <script>
        document.getElementById("hotelSelect").addEventListener("change", function () {
            const hotelId = this.value;

            fetch(`/Rooms/GetFloorsByHotel?hotelId=${hotelId}`)
                .then(res => res.json())
                .then(floors => {

                    const floorSelect = document.getElementById("floorSelect");
                    floorSelect.innerHTML = "";

                    floors.forEach(f => {
                        const opt = document.createElement("option");
                        opt.value = f.floorId;
                        opt.textContent = `Floor ${f.floorNumber} (${f.floorStatus})`;
                        floorSelect.appendChild(opt);
                    });
                });
        });
    </script>
}
